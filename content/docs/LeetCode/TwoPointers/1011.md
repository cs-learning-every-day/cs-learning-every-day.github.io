
```c++
class Solution {
public:
    int shipWithinDays(vector<int>& weights, int days) {
        int max_weight = 0, total_weight = 0;
        for (auto w : weights) {
            if (w > max_weight) max_weight = w;
            total_weight += w;
        }

        int lo = max_weight, hi = total_weight;
        while (lo < hi) {
            int mid = (lo + hi) >> 1;
            if (check(weights, mid, days)) {
                hi = mid;
            } else {
                lo = mid + 1;
            }
        }
        return lo;
    }

    bool check(vector<int> &weights, int cap, int days) {
        int total = 0;
        int need_days = 1;
        for (auto w : weights) {
            if (total + w > cap) {
                total = w;
                need_days++;
            } else {
                total += w;
            }
        }
        // std::cout << "cap: " << cap << need_days << std::endl;
        return need_days <= days;
    }
};
```